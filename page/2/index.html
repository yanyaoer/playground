<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>yányào.com | Home </title><link rel=icon type=image/png href=#ZgotmplZ><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta property="og:image" content><link rel=alternate type=application/rss+xml href=https://xn--ynyo-2nad.com/index.xml title=yányào.com><meta property="og:url" content="https://xn--ynyo-2nad.com/"><meta property="og:site_name" content="yányào.com"><meta property="og:title" content="yányào.com"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="yányào.com"><script src=https://xn--ynyo-2nad.com/js/feather.min.js></script><link href=https://xn--ynyo-2nad.com/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://xn--ynyo-2nad.com/css/main.5cebd7d4fb2b97856af8d32a6def16164fcf7d844e98e236fcb3559655020373.css></head><body><div class=content><header><div class=main><a href=https://xn--ynyo-2nad.com/>yányào.com</a></div><nav><a href=/>Home</a>
<a href=/posts>Posts</a>
<a href=/tags>Tags</a></nav></header><main class=list><div class=site-description><p>looking a wood sprite in the forest</p></div><section class=list-item><h1 class=title><a href=/posts/pour-over-coffee-makers/>Pour Over Coffee Makers</a></h1><time>May 15, 2020</time><br><div class=description><h2 id=办公室日常用品>办公室日常用品</h2><ul><li>hario v60 2人份玻璃滤杯 <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></li><li>hario v60 600ml 云朵分享壶 <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></li><li>comandante c40 手摇磨豆机 <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></li><li>kalita 700ml 细嘴壶 <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup></li><li>rivers seek 随手杯 <sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup></li></ul><hr><ul><li><p>2020-0615 新购入 Mr.clever 聪明杯 <sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup></p></li><li><p>2020-0622 新购入 hario drip kettle air <sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>，
用了两次手感偏轻水流控制得不稳 T_T</p></li><li><p>2020-1027 新购入 fellow ode 电动磨豆机 <sup id=fnref:8><a href=#fn:8 class=footnote-ref role=doc-noteref>8</a></sup></p></li><li><p>2020-1109 新购入 fellow stagg ekg 温控壶 <sup id=fnref:9><a href=#fn:9 class=footnote-ref role=doc-noteref>9</a></sup></p></li><li><p>2023-half 新购入 hoop 澡盆滤杯 <sup id=fnref:10><a href=#fn:10 class=footnote-ref role=doc-noteref>10</a></sup>，类似聪明杯但会拉长萃取时间</p></li></ul><p>每天一早 <del>中午</del> 到公司开始烧水，然后吭呲吭呲摇 40g 豆子兑 600ml 左右的水</p><p>手法就比较 <del>随意</del> 业余啦，主要参考下面两个视频，出品大概率自己都还挺喜欢的
<strong>按比例加注水量翻倍</strong></p><h3 id=46-method-by-tetsu-kasuya-4-6method>&ldquo;4:6 method&rdquo; by Tetsu Kasuya <sup id=fnref:11><a href=#fn:11 class=footnote-ref role=doc-noteref>11</a></sup></h3><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/wmCW8xSWGZY?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><h3 id=the-ultimate-v60-technique-by-james-hoffmann>&ldquo;The Ultimate V60 Technique&rdquo; by James Hoffmann</h3><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/AI4ynXzkSQo?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><h2 id=家庭版>家庭版</h2><ul><li>baratza encore 电动磨豆器 <sup id=fnref:12><a href=#fn:12 class=footnote-ref role=doc-noteref>12</a></sup></li><li>kinto OCT 2人份陶瓷滤杯 <sup id=fnref:13><a href=#fn:13 class=footnote-ref role=doc-noteref>13</a></sup></li><li>ikea vardagen 500ml 玻璃量杯 <sup id=fnref:14><a href=#fn:14 class=footnote-ref role=doc-noteref>14</a></sup></li><li>muji 万古烧马克杯 <sup id=fnref:15><a href=#fn:15 class=footnote-ref role=doc-noteref>15</a></sup></li></ul><hr><ul><li>2020-0615 新购入 hario filter-in 冷萃瓶 <del>已碎</del>，21年夏再次购入 <sup id=fnref:16><a href=#fn:16 class=footnote-ref role=doc-noteref>16</a></sup></li></ul><p>刚开始的时候装备上交了不少学费，比如：<del>电动砍豆机</del>、<del>廉价手磨</del>、<del>aeropress</del>，
虽然不能一概而论，实际上很大程度还是遵循一分钱一分货的原则，性能越好则价格呈指数上涨
条件允许的话尽量选择好一点的设备，毕竟也是天天要用的家伙事</p>&mldr;</div><a class=readmore href=/posts/pour-over-coffee-makers/>Read more ⟶</a></section><section class=list-item><h1 class=title><a href=/posts/mastodon/>Mastodon</a></h1><time>May 15, 2020</time><br><div class=description><p><code>Mastodon 长毛象</code><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> &ndash; 基于 rubyonrails/reactjs/nodejs 开发的分布式 &
去中心化 twiter clone。利用空闲时间在 aws lightsail 上开了个实例把服务跑了起来</p><p>一开始走了些弯路，因为选机房和省钱的缘故，重建了若干次操作系统，最后的选择是
tokyo+cloudflare，没错我又套了 cdn，实在是海外线路到北京联通不稳定</p><p>安装步骤没有使用 docker 而是参考文档从源码安装<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，原因和解决方案如下：</p><ul><li><p><del>机器用 $3.5/mo 512mem 最便宜的那档消费降级</del>(512M 内存重启会拉垮弱鸡，服务已迁移到 oraclecloud)，出于 net/io 性能考虑就不使 docker 啦</p></li><li><p>内存问题，<code>RAILS_ENV=production bundle exec rake mastodon:setup</code>
这一步骤执行到 <code>rails assets:precompile</code>，
不管是在 docker 里跑还是直接运行都会报 swap 分区不足，找到两个方案来解决:</p></li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#586e75># create swapfile &lt;https://linuxize.com/post/create-a-linux-swap-file/&gt;</span>
</span></span><span style=display:flex><span>$ sudo fallocate -l 2G /swapfile
</span></span><span style=display:flex><span>$ sudo chmod <span style=color:#2aa198>600</span> /swapfile
</span></span><span style=display:flex><span>$ sudo mkswap /swapfile
</span></span><span style=display:flex><span>$ sudo swapon /swapfile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># verify active</span>
</span></span><span style=display:flex><span>$ sudo swapon --show
</span></span><span style=display:flex><span><span style=color:#586e75># optional: low value is better for production</span>
</span></span><span style=display:flex><span>$ sudo sysctl vm.swappiness<span style=color:#719e07>=</span><span style=color:#2aa198>10</span>
</span></span></code></pre></div><h2 id=邮件配置>邮件配置</h2><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#586e75># By default the memory limit in Node. js is 512 mb, </span>
</span></span><span style=display:flex><span><span style=color:#586e75># use command —- max-old-space-size to increase the memory limit</span>
</span></span><span style=display:flex><span>$ <span style=color:#268bd2>NODE_OPTIONS</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;--max-old-space-size=4096&#34;</span> <span style=color:#268bd2>RAILS_ENV</span><span style=color:#719e07>=</span>production bundle <span style=color:#b58900>exec</span> rails assets:precompile
</span></span></code></pre></div><p>直接配置 localhost 发送邮件无效，先用 <a href=https://sendgrid.com/>sendgrid</a> 免费版顶着, 一天 100 封邮件目前够用</p>&mldr;</div><a class=readmore href=/posts/mastodon/>Read more ⟶</a></section><section class=list-item><h1 class=title><a href=/posts/gitlab-repo/>Gitlab Repo</a></h1><time>May 9, 2020</time><br><div class=description><p>gitlab 里面已经有十来个 group，几百个 project，虽然不一定会每个项目都参与，
但是为了快速同步代码，又捡起了 android 开发常用的 repo 命令来管理多项目代码。
这里使用了 gitlab graphql 接口来遍历项目生成分组的 manifest 文件</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#586e75>#!/usr/bin/env python</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>import</span> argparse
</span></span><span style=display:flex><span><span style=color:#719e07>import</span> json
</span></span><span style=display:flex><span><span style=color:#719e07>import</span> os
</span></span><span style=display:flex><span><span style=color:#719e07>import</span> urllib2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GITLAB_HOST <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;gitlab.mydomain.com&#34;</span>
</span></span><span style=display:flex><span>GITLAB_SSH_URL <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;ssh://git@&#34;</span> <span style=color:#719e07>+</span> GITLAB_HOST
</span></span><span style=display:flex><span>GITLAB_GRAPHQL_URL <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;https://&#34;</span> <span style=color:#719e07>+</span> GITLAB_HOST <span style=color:#719e07>+</span> <span style=color:#2aa198>&#34;/api/graphql&#34;</span>
</span></span><span style=display:flex><span>GITLAB_TOKEN <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;&#34;</span>
</span></span><span style=display:flex><span>GITLAB_GROUP <span style=color:#719e07>=</span> [<span style=color:#2aa198>&#34;&#34;</span>]
</span></span><span style=display:flex><span>BLACK_LIST <span style=color:#719e07>=</span> (<span style=color:#2aa198>&#34;&#34;</span>,)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># 以上配置修改为自己的设定</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>template <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;&#34;&#34;&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span></span></span><span style=display:flex><span><span style=color:#2aa198>&lt;!-- autogen by gen.py, do not edit this file --&gt;
</span></span></span><span style=display:flex><span><span style=color:#2aa198>&lt;manifest&gt;
</span></span></span><span style=display:flex><span><span style=color:#2aa198>  &lt;remote  name=&#34;origin&#34; fetch=&#34;</span><span style=color:#2aa198>{ssh_url}</span><span style=color:#2aa198>&#34; /&gt;
</span></span></span><span style=display:flex><span><span style=color:#2aa198>  &lt;default revision=&#34;master&#34; remote=&#34;origin&#34; sync-c=&#34;true&#34; sync-j=&#34;4&#34; /&gt;
</span></span></span><span style=display:flex><span><span style=color:#2aa198></span><span style=color:#2aa198>{content}</span><span style=color:#2aa198>
</span></span></span><span style=display:flex><span><span style=color:#2aa198>&lt;/manifest&gt;&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>def</span> <span style=color:#268bd2>write_file</span>(content, filename<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;default.xml&#34;</span>):
</span></span><span style=display:flex><span>    _file <span style=color:#719e07>=</span> os<span style=color:#719e07>.</span>path<span style=color:#719e07>.</span>join(os<span style=color:#719e07>.</span>path<span style=color:#719e07>.</span>dirname(__file__), filename)
</span></span><span style=display:flex><span>    <span style=color:#719e07>with</span> <span style=color:#b58900>open</span>(_file, <span style=color:#2aa198>&#34;w&#34;</span>) <span style=color:#719e07>as</span> f:
</span></span><span style=display:flex><span>        f<span style=color:#719e07>.</span>write(template<span style=color:#719e07>.</span>format(content<span style=color:#719e07>=</span>content, ssh_url<span style=color:#719e07>=</span>GITLAB_SSH_URL))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>def</span> <span style=color:#268bd2>fetch_project_of_group</span>(group, write<span style=color:#719e07>=</span><span style=color:#cb4b16>True</span>):
</span></span><span style=display:flex><span>    data <span style=color:#719e07>=</span> <span style=color:#2aa198>&#39;{ group(fullPath: &#34;</span><span style=color:#2aa198>%s</span><span style=color:#2aa198>&#34;) { projects { nodes { fullPath } } }}&#39;</span> <span style=color:#719e07>%</span> group
</span></span><span style=display:flex><span>    req <span style=color:#719e07>=</span> urllib2<span style=color:#719e07>.</span>Request(
</span></span><span style=display:flex><span>        GITLAB_GRAPHQL_URL,
</span></span><span style=display:flex><span>        data<span style=color:#719e07>=</span>json<span style=color:#719e07>.</span>dumps(<span style=color:#b58900>dict</span>(query<span style=color:#719e07>=</span>data)),
</span></span><span style=display:flex><span>        headers<span style=color:#719e07>=</span>{
</span></span><span style=display:flex><span>            <span style=color:#2aa198>&#34;Authorization&#34;</span>: <span style=color:#2aa198>&#34;Bearer &#34;</span> <span style=color:#719e07>+</span> GITLAB_TOKEN,
</span></span><span style=display:flex><span>            <span style=color:#2aa198>&#34;Content-Type&#34;</span>: <span style=color:#2aa198>&#34;application/json&#34;</span>,
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    resp <span style=color:#719e07>=</span> json<span style=color:#719e07>.</span>load(urllib2<span style=color:#719e07>.</span>urlopen(req))
</span></span><span style=display:flex><span>    content <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;</span><span style=color:#cb4b16>\n</span><span style=color:#2aa198>&#34;</span><span style=color:#719e07>.</span>join(
</span></span><span style=display:flex><span>        [
</span></span><span style=display:flex><span>            <span style=color:#2aa198>&#39;&lt;project path=&#34;</span><span style=color:#2aa198>{d}</span><span style=color:#2aa198>&#34; name=&#34;</span><span style=color:#2aa198>{d}</span><span style=color:#2aa198>&#34;/&gt;&#39;</span><span style=color:#719e07>.</span>format(d<span style=color:#719e07>=</span>p[<span style=color:#2aa198>&#34;fullPath&#34;</span>])
</span></span><span style=display:flex><span>            <span style=color:#719e07>for</span> p <span style=color:#719e07>in</span> resp[<span style=color:#2aa198>&#34;data&#34;</span>][<span style=color:#2aa198>&#34;group&#34;</span>][<span style=color:#2aa198>&#34;projects&#34;</span>][<span style=color:#2aa198>&#34;nodes&#34;</span>]
</span></span><span style=display:flex><span>            <span style=color:#719e07>if</span> p[<span style=color:#2aa198>&#34;fullPath&#34;</span>] <span style=color:#719e07>not</span> <span style=color:#719e07>in</span> BLACK_LIST
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>if</span> write:
</span></span><span style=display:flex><span>        write_file(content, filename<span style=color:#719e07>=</span>group<span style=color:#719e07>.</span>replace(<span style=color:#2aa198>&#34;/&#34;</span>, <span style=color:#2aa198>&#34;-&#34;</span>) <span style=color:#719e07>+</span> <span style=color:#2aa198>&#34;-group.xml&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#719e07>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#719e07>return</span> content
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>def</span> <span style=color:#268bd2>main</span>():
</span></span><span style=display:flex><span>    parser <span style=color:#719e07>=</span> argparse<span style=color:#719e07>.</span>ArgumentParser(description<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;Process some projects.&#34;</span>)
</span></span><span style=display:flex><span>    parser<span style=color:#719e07>.</span>add_argument(
</span></span><span style=display:flex><span>        <span style=color:#2aa198>&#34;-G&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#2aa198>&#34;--group&#34;</span>,
</span></span><span style=display:flex><span>        help<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;for group/subgroup or all&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#b58900>type</span><span style=color:#719e07>=</span><span style=color:#b58900>str</span>,
</span></span><span style=display:flex><span>        choices<span style=color:#719e07>=</span>ns <span style=color:#719e07>+</span> [<span style=color:#2aa198>&#34;all&#34;</span>, <span style=color:#2aa198>&#34;default&#34;</span>],
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    arg <span style=color:#719e07>=</span> parser<span style=color:#719e07>.</span>parse_args()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>if</span> arg<span style=color:#719e07>.</span>group <span style=color:#719e07>==</span> <span style=color:#2aa198>&#34;all&#34;</span>:
</span></span><span style=display:flex><span>        <span style=color:#719e07>for</span> x <span style=color:#719e07>in</span> GITLAB_GROUP:
</span></span><span style=display:flex><span>            fetch_project_of_group(x)
</span></span><span style=display:flex><span>        d <span style=color:#719e07>=</span> [fetch_project_of_group(x, write<span style=color:#719e07>=</span><span style=color:#cb4b16>False</span>) <span style=color:#719e07>for</span> x <span style=color:#719e07>in</span> GITLAB_GROUP]
</span></span><span style=display:flex><span>        write_file(<span style=color:#2aa198>&#34;</span><span style=color:#cb4b16>\n</span><span style=color:#2aa198>&#34;</span><span style=color:#719e07>.</span>join(d))
</span></span><span style=display:flex><span>    <span style=color:#719e07>elif</span> arg<span style=color:#719e07>.</span>group <span style=color:#719e07>==</span> <span style=color:#2aa198>&#34;default&#34;</span>:
</span></span><span style=display:flex><span>        d <span style=color:#719e07>=</span> [fetch_project_of_group(x, write<span style=color:#719e07>=</span><span style=color:#cb4b16>False</span>) <span style=color:#719e07>for</span> x <span style=color:#719e07>in</span> GITLAB_GROUP]
</span></span><span style=display:flex><span>        write_file(<span style=color:#2aa198>&#34;</span><span style=color:#cb4b16>\n</span><span style=color:#2aa198>&#34;</span><span style=color:#719e07>.</span>join(d))
</span></span><span style=display:flex><span>    <span style=color:#719e07>else</span>:
</span></span><span style=display:flex><span>        fetch_project_of_group(arg<span style=color:#719e07>.</span>group)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>if</span> __name__ <span style=color:#719e07>==</span> <span style=color:#2aa198>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p><strong>USAGE:</strong> 创建完 manifest 文件之后提交到仓库就可以愉快的玩耍啦</p>&mldr;</div><a class=readmore href=/posts/gitlab-repo/>Read more ⟶</a></section><section class=list-item><h1 class=title><a href=/posts/dash-replacement/>Dash Replacement with tmux</a></h1><time>May 7, 2020</time><br><div class=description><p>通过 tmux 快捷集成替换 dash.app 查询开发文档</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ brew install dasht
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ dasht-docsets | tr &#39;A-Z&#39; &#39;a-z&#39;
</span></span><span style=display:flex><span>go
</span></span><span style=display:flex><span>javascript
</span></span><span style=display:flex><span>python_3
</span></span><span style=display:flex><span>rust
</span></span><span style=display:flex><span>tornado
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span># tmux.conf quick start
</span></span><span style=display:flex><span>bind -n S-up command-prompt -p &#39;docset:&#39; &#34;splitw -h -fb -l 80 dasht &#39;%%&#39;&#34;
</span></span></code></pre></div>&mldr;</div><a class=readmore href=/posts/dash-replacement/>Read more ⟶</a></section><section class=list-item><h1 class=title><a href=/posts/cloudflare-gost/>Cloudflare Gost</a></h1><time>May 7, 2020</time><br><div class=description><p>从清明节开始，稳定运行好几年的 ss 服务器终于阵亡了，所有端口全挂。一直蹭公司的 vpn 查资料也挺到了五一，实在拖延够够的就再另外开了一台机器中转过去迁移数据，不过嘛年纪大了又开始犯懒，企图拯救获得资格认证的机器，通过一番网上冲浪学习到了目前(实测可用)能满足我需求的方案。简单来说就是：cloudflare[后文简称为 cf] + websockets over gost，实际的客户端通过 cdn 代理再接入服务</p><p>有几个需要注意的地方：</p><ul><li><p>gost 启动时绑定的 localhost 不直接对外访问，走了 caddy 的转发，而这一步和 cf 的 ssl 证书配置会造成不停的重定向跳转，需要将 cf 加密模式配置为 flexible</p></li><li><p>然后修改 caddy 的域名配置为 <a href=http://domain.com>http://domain.com</a> <a href=https://domain.com>https://domain.com</a> { &mldr; } 阻止 cf 和 caddy 之间的 http -> https</p></li><li><p>gost 服务端监听 ws 协议，本地的 gost 客户端转发 wss 协议连接 cf_domain:443</p></li><li><p>需要鉴权的方案使用 socks5+wss://username:password@domain:port</p></li><li><p>android 客户端的设置，因为使用了 ws 协议，所以需要将域名写入到插件的配置里，直接用域名变量无法解析</p></li></ul><p>具体配置参考官方文档，<strong>一切浪费的时间都是源于没认真仔细看文档</strong></p><ul><li><a href=https://github.com/haoel/haoel.github.io>https://github.com/haoel/haoel.github.io</a></li><li><a href=https://github.com/ginuerzh/gost>https://github.com/ginuerzh/gost</a></li><li><a href=https://github.com/xausky/ShadowsocksGostPlugin>https://github.com/xausky/ShadowsocksGostPlugin</a></li></ul><p><strong>update 2021-03-01</strong> 由于 shawdowsocks 的 android 客户端升级导致插件不可用，另外部署了 <a href=https://github.com/txthinking/brook>brook</a> wsserver 给手机使用</p>&mldr;</div><a class=readmore href=/posts/cloudflare-gost/>Read more ⟶</a></section><section class=list-item><h1 class=title><a href=/posts/webpack-resolve-local-module/>webpack resolve local module</a></h1><time>Jan 13, 2017</time><br><div class=description><p>最近的项目刚开始，设计的目录层级有点深<br>经常会在好几层本地路径之间互相引用</p><p><code>import Image from '../../../../components/image'</code></p><p>这层层叠叠的路径写起来实在丑陋<br>不由得想起 Python 从项目根目录引用模块<br>然后研究了一下 Node.js 里的几种简易实现</p><p>干脆利落的软连接: <code>ln -s node_modules src</code></p><p>修改环境变量: <code>NODE_PATH=. node app</code></p><p>从本地目录安装:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#586e75>// package.json 
</span></span></span><span style=display:flex><span><span style=color:#586e75>// 需要运行 npm install
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>{
</span></span><span style=display:flex><span>  <span style=color:#2aa198>&#34;name&#34;</span><span style=color:#719e07>:</span> <span style=color:#2aa198>&#34;baz&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#2aa198>&#34;dependencies&#34;</span><span style=color:#719e07>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#2aa198>&#34;foo&#34;</span><span style=color:#719e07>:</span> <span style=color:#2aa198>&#34;file: ./src&#34;</span>,
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>另外还有些修改 global，或者引入其他 require 实现的方法就不再一一列出了<br>最终选择的是修改 webpack 配置</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>// webpack.config.js
</span></span><span style=display:flex><span>resolve: {
</span></span><span style=display:flex><span>  modulesDirectories: [__dirname, &#39;node_modules&#39;],
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><a href=https://gist.github.com/branneman/8048520>https://gist.github.com/branneman/8048520</a>
<a href=http://stackoverflow.com/questions/10860244/how-to-make-the-require-in-node-js-to-be-always-relative-to-the-root-folder-of-t/41078266#41078266>http://stackoverflow.com/questions/10860244/how-to-make-the-require-in-node-js-to-be-always-relative-to-the-root-folder-of-t/41078266#41078266</a>
<a href=https://webpack.github.io/docs/configuration.html#resolve-modulesdirectories>https://webpack.github.io/docs/configuration.html#resolve-modulesdirectories</a></p>&mldr;</div><a class=readmore href=/posts/webpack-resolve-local-module/>Read more ⟶</a></section><section class=list-item><h1 class=title><a href=/posts/leonard-cohen-you-want-it-darker/>Leonard Cohen - you want it darker</a></h1><time>Oct 25, 2016</time><br><div class=description><h2 id=年度最佳>年度最佳</h2><p><a href=https://open.spotify.com/album/3jeTB3j3QmUs8SPIVleHtU><img src=images/you-want-it-darker.jpg alt="you want it darker"></a></p><p><a href=https://open.spotify.com/album/3jeTB3j3QmUs8SPIVleHtU>you want it darker</a></p><p>循环听了好几天</p><p>干净低沉的嗓音加配乐</p><p>愈发担心以后听不到了怎么办 😢～</p>&mldr;</div><a class=readmore href=/posts/leonard-cohen-you-want-it-darker/>Read more ⟶</a></section><section class=list-item><h1 class=title><a href=/posts/web-audio/>web audio</a></h1><time>Jun 15, 2016</time><br><div class=description><p>照文档撸了一下 AudioContext 可视化音频<br>桌面浏览器上 Safari 9, Chrome stable 绘制正常<br>移动端只有微信的 webview 能工作, 纯玩票叻
<img src=https://mdn.mozillademos.org/files/7977/wave.png alt=wave></p><p>ref:
<a href=https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Visualizations_with_Web_Audio_API>https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Visualizations_with_Web_Audio_API</a></p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#719e07>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#268bd2>html</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#268bd2>head</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#268bd2>meta</span> charset<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;utf-8&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#268bd2>meta</span> name<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;viewport&#34;</span> content<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;width=device-width, user-scalable=no&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#268bd2>title</span>&gt;AV&lt;/<span style=color:#268bd2>title</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#268bd2>head</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#268bd2>body</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#268bd2>canvas</span> id<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;vis&#34;</span>&gt;&lt;/<span style=color:#268bd2>canvas</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#268bd2>audio</span> id<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;av&#34;</span> src<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;YOUR_AUDIO_FILE&#34;</span>&gt;&lt;/<span style=color:#268bd2>audio</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#268bd2>script</span> src<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;index.js&#34;</span>&gt;&lt;/<span style=color:#268bd2>script</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#268bd2>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#268bd2>html</span>&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#b58900>window</span>.AudioContext <span style=color:#719e07>=</span> <span style=color:#b58900>window</span>.AudioContext <span style=color:#719e07>||</span> <span style=color:#b58900>window</span>.webkitAudioContext <span style=color:#719e07>||</span> <span style=color:#b58900>window</span>.mozAudioContext;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>window</span>.onload <span style=color:#719e07>=</span> <span style=color:#268bd2>function</span>(){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#268bd2>var</span> canvas <span style=color:#719e07>=</span> <span style=color:#b58900>document</span>.getElementById(<span style=color:#2aa198>&#39;vis&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#268bd2>var</span> canvasCtx <span style=color:#719e07>=</span> canvas.getContext(<span style=color:#2aa198>&#39;2d&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#268bd2>var</span> isPlaying <span style=color:#719e07>=</span> <span style=color:#cb4b16>true</span>;
</span></span><span style=display:flex><span>  <span style=color:#268bd2>var</span> audio <span style=color:#719e07>=</span> <span style=color:#b58900>document</span>.getElementById(<span style=color:#2aa198>&#39;av&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#268bd2>var</span> audioCtx <span style=color:#719e07>=</span> <span style=color:#719e07>new</span> AudioContext();
</span></span><span style=display:flex><span>  <span style=color:#268bd2>var</span> analyser <span style=color:#719e07>=</span> audioCtx.createAnalyser();
</span></span><span style=display:flex><span>  <span style=color:#268bd2>var</span> audioSrc <span style=color:#719e07>=</span> audioCtx.createMediaElementSource(audio);
</span></span><span style=display:flex><span>  audioSrc.connect(analyser);
</span></span><span style=display:flex><span>  analyser.connect(audioCtx.destination);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  analyser.fftSize <span style=color:#719e07>=</span> <span style=color:#2aa198>2048</span>;
</span></span><span style=display:flex><span>  <span style=color:#268bd2>var</span> bufferLength <span style=color:#719e07>=</span> analyser.fftSize;
</span></span><span style=display:flex><span>  dataArray <span style=color:#719e07>=</span> <span style=color:#719e07>new</span> Uint8Array(bufferLength);
</span></span><span style=display:flex><span>  analyser.getByteTimeDomainData(dataArray);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  WIDTH <span style=color:#719e07>=</span> <span style=color:#2aa198>500</span>;
</span></span><span style=display:flex><span>  HEIGHT <span style=color:#719e07>=</span> <span style=color:#2aa198>150</span>;
</span></span><span style=display:flex><span>  <span style=color:#268bd2>function</span> draw() {
</span></span><span style=display:flex><span>    requestAnimationFrame(draw);
</span></span><span style=display:flex><span>    <span style=color:#719e07>if</span> (<span style=color:#719e07>!</span>isPlaying) <span style=color:#719e07>return</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    analyser.getByteTimeDomainData(dataArray);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    canvasCtx.fillStyle <span style=color:#719e07>=</span> <span style=color:#2aa198>&#39;rgb(200, 200, 200)&#39;</span>;
</span></span><span style=display:flex><span>    canvasCtx.fillRect(<span style=color:#2aa198>0</span>, <span style=color:#2aa198>0</span>, WIDTH, HEIGHT);
</span></span><span style=display:flex><span>    canvasCtx.lineWidth <span style=color:#719e07>=</span> <span style=color:#2aa198>2</span>;
</span></span><span style=display:flex><span>    canvasCtx.strokeStyle <span style=color:#719e07>=</span> <span style=color:#2aa198>&#39;rgb(0, 0, 0)&#39;</span>;
</span></span><span style=display:flex><span>    canvasCtx.beginPath();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>var</span> sliceWidth <span style=color:#719e07>=</span> WIDTH <span style=color:#719e07>*</span> <span style=color:#2aa198>1.0</span> <span style=color:#719e07>/</span> bufferLength;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>var</span> x <span style=color:#719e07>=</span> <span style=color:#2aa198>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>for</span>(<span style=color:#268bd2>var</span> i <span style=color:#719e07>=</span> <span style=color:#2aa198>0</span>; i <span style=color:#719e07>&lt;</span> bufferLength; i<span style=color:#719e07>++</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>var</span> v <span style=color:#719e07>=</span> dataArray[i] <span style=color:#719e07>/</span> <span style=color:#2aa198>128.0</span>;
</span></span><span style=display:flex><span>      <span style=color:#268bd2>var</span> y <span style=color:#719e07>=</span> v <span style=color:#719e07>*</span> HEIGHT<span style=color:#719e07>/</span><span style=color:#2aa198>2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#719e07>if</span>(i <span style=color:#719e07>===</span> <span style=color:#2aa198>0</span>) {
</span></span><span style=display:flex><span>        canvasCtx.moveTo(x, y);
</span></span><span style=display:flex><span>      } <span style=color:#719e07>else</span> {
</span></span><span style=display:flex><span>        canvasCtx.lineTo(x, y);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      x <span style=color:#719e07>+=</span> sliceWidth;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    canvasCtx.lineTo(canvas.width, canvas.height<span style=color:#719e07>/</span><span style=color:#2aa198>2</span>);
</span></span><span style=display:flex><span>    canvasCtx.stroke();
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  draw();
</span></span><span style=display:flex><span>  audio.play();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#b58900>document</span>.body.onclick <span style=color:#719e07>=</span> <span style=color:#268bd2>function</span>() {
</span></span><span style=display:flex><span>    console.log(audio, isPlaying);
</span></span><span style=display:flex><span>    <span style=color:#719e07>if</span> (isPlaying) {
</span></span><span style=display:flex><span>      audio.pause();
</span></span><span style=display:flex><span>      isPlaying <span style=color:#719e07>=</span> <span style=color:#cb4b16>false</span>;
</span></span><span style=display:flex><span>    } <span style=color:#719e07>else</span> {
</span></span><span style=display:flex><span>      audio.play();
</span></span><span style=display:flex><span>      isPlaying <span style=color:#719e07>=</span> <span style=color:#cb4b16>true</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div>&mldr;</div><a class=readmore href=/posts/web-audio/>Read more ⟶</a></section><section class=list-item><h1 class=title><a href=/posts/move-to-caddy/>move to caddy</a></h1><time>Apr 26, 2016</time><br><div class=description><p>去年用 Hexo 搭建的日志已经好几个月没更新了，最近休假有点空闲就继续更新吧。<br>先从 Github 迁移回自己的 Linode，然后安装一个 Caddyserver<a href=https://caddyserver.com/>1</a> 来渲染 markdown</p><blockquote><p>Caddy is a unique web server with a modern feature set. Think nginx or Apache, but written in Go. With Caddy, you can serve your websites over HTTP/2. It can act as a reverse proxy and load balancer. Front your PHP apps with it. You can even deploy your site with git push. Cool, right?<a href=https://blog.gopheracademy.com/caddy-a-look-inside/>2</a></p></blockquote><h2 id=download-and-install-systemd>Download and install systemd</h2><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget -O <span style=color:#2aa198>&#39;caddy.tar.gz&#39;</span> <span style=color:#2aa198>&#39;https://caddyserver.com/download/build?os=linux&amp;arch=amd64&amp;features=git%2Cipfilter&#39;</span>
</span></span><span style=display:flex><span>tar zxf caddy.tar.gz
</span></span><span style=display:flex><span>mkdir /opt/caddy
</span></span><span style=display:flex><span>mkdir /var/run/caddy/
</span></span><span style=display:flex><span>chown caddy:caddy -R /opt/caddy
</span></span><span style=display:flex><span>chown caddy:caddy -R /var/run/caddy
</span></span><span style=display:flex><span>mv caddy /opt/caddy/
</span></span><span style=display:flex><span>useradd -d /var/run/caddy --system caddy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>chmod <span style=color:#2aa198>644</span> /etc/systemd/system/caddy.service
</span></span><span style=display:flex><span>systemctl <span style=color:#b58900>enable</span> caddy.service
</span></span><span style=display:flex><span>systemctl start caddy.service
</span></span><span style=display:flex><span>systemctl status caddy.service
</span></span></code></pre></div><p><a href=https://github.com/caddyserver/examples/blob/master/systemd%2Fcaddy.service>https://github.com/caddyserver/examples/blob/master/systemd%2Fcaddy.service</a></p>&mldr;</div><a class=readmore href=/posts/move-to-caddy/>Read more ⟶</a></section><section class=list-item><h1 class=title><a href=/posts/mongodb-backup/>mongodb backup</a></h1><time>Dec 22, 2015</time><br><div class=description><p>有台机器准备2月份下架
记一个 mongodb 备份小脚本 :)</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#719e07>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#719e07></span><span style=color:#586e75># vim: set et sw=2 ts=2 sts=2 ff=unix fenc=utf8:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>MONGO_DATABASE</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;_name_&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>MONGO_HOST</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;_ip_&#34;</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>MONGO_PORT</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;_prot_&#34;</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>TIMESTAMP</span><span style=color:#719e07>=</span><span style=color:#586e75>`</span>date +%Y-%m-%dT%H:%M:%S<span style=color:#586e75>`</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>MONGODUMP_PATH</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;/usr/bin/mongodump&#34;</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>BACKUPS_DIR</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;/data/dumps/&#34;</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>BACKUP_NAME</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$MONGO_DATABASE</span><span style=color:#2aa198>-</span><span style=color:#268bd2>$TIMESTAMP</span><span style=color:#2aa198>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>while</span> <span style=color:#b58900>test</span> <span style=color:#268bd2>$#</span> -gt <span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span><span style=color:#719e07>do</span>
</span></span><span style=display:flex><span>  <span style=color:#719e07>case</span> <span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$1</span><span style=color:#2aa198>&#34;</span> in
</span></span><span style=display:flex><span>    -m<span style=color:#719e07>)</span> <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;backup mongthly and clear week_dir&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#586e75>#rm $BACKUPS_DIR&#34;week/*&#34;</span>
</span></span><span style=display:flex><span>      find <span style=color:#268bd2>$BACKUPS_DIR</span><span style=color:#2aa198>&#34;week&#34;</span> -type f -name <span style=color:#2aa198>&#39;*.tgz&#39;</span> -delete
</span></span><span style=display:flex><span>      tar -czPf <span style=color:#268bd2>$BACKUPS_DIR</span><span style=color:#2aa198>&#34;month/&#34;</span><span style=color:#268bd2>$BACKUP_NAME</span>.tgz <span style=color:#268bd2>$BACKUPS_DIR$MONGO_DATABASE</span>
</span></span><span style=display:flex><span>      ;;
</span></span><span style=display:flex><span>    -w<span style=color:#719e07>)</span> <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;backup weekly&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;tar -czPf </span><span style=color:#268bd2>$BACKUPS_DIR</span><span style=color:#2aa198>&#34;</span>week/<span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$BACKUP_NAME</span><span style=color:#2aa198>.tgz </span><span style=color:#268bd2>$BACKUPS_DIR$MONGO_DATABASE</span><span style=color:#2aa198>&#34;</span>
</span></span><span style=display:flex><span>      ;;
</span></span><span style=display:flex><span>    -d<span style=color:#719e07>)</span> <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;just dump&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#268bd2>$MONGODUMP_PATH</span> -d <span style=color:#268bd2>$MONGO_DATABASE</span> --out <span style=color:#268bd2>$BACKUPS_DIR</span>
</span></span><span style=display:flex><span>      ;;
</span></span><span style=display:flex><span>    *<span style=color:#719e07>)</span> <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;do nothing&#34;</span>
</span></span><span style=display:flex><span>      ;;
</span></span><span style=display:flex><span>  <span style=color:#719e07>esac</span>
</span></span><span style=display:flex><span>  <span style=color:#b58900>shift</span>
</span></span><span style=display:flex><span><span style=color:#719e07>done</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span># crontab -e
</span></span><span style=display:flex><span>10 3 * * * /bin/bash $HOME/bin/mongobackup.sh -d &gt; /dev/null 2&gt;&amp;1
</span></span><span style=display:flex><span>20 3 * * 1 /bin/bash $HOME/bin/mongobackup.sh -w &gt; /dev/null 2&gt;&amp;1
</span></span><span style=display:flex><span>30 3 1 * * /bin/bash $HOME/bin/mongobackup.sh -m &gt; /dev/null 2&gt;&amp;1
</span></span></code></pre></div><p>每天早上3点按天／周／月分别保存</p>&mldr;</div><a class=readmore href=/posts/mongodb-backup/>Read more ⟶</a></section><ul class=pagination><span class="page-item page-prev"><a href=/ class=page-link aria-label=Previous><span aria-hidden=true>← Prev</span></a>
</span><span class="page-item page-next"><a href=/page/3/ class=page-link aria-label=Next><span aria-hidden=true>Next →</span></a></span></ul></main><footer><div style=display:flex><a class=soc href=/index.xml rel=me title=RSS><i data-feather=rss></i></a>
<a class=border></a><a class=soc href=/daydayup/ rel=me title=Status><i data-feather=activity></i></a>
<a class=border></a><a class=soc href=https://yankuiyi.com/ rel=me title=microfeed><i data-feather=radio></i></a>
<a class=border></a><a class=soc href=https://fouland.com/ rel=me title=Logseq><i data-feather=inbox></i></a>
<a class=border></a><a class=soc href=https://at.yadanhe.com/ rel=me title=Mastodon><i data-feather=at-sign></i></a>
<a class=border></a></div><div class=footer-info>2024 <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script>feather.replace()</script></div></body></html>